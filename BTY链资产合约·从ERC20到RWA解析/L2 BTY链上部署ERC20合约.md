# BTY链上部署ERC20合约

> 🚀 **从零开始部署ERC20代币合约，掌握完整的ERC20合约发行流程**

本指南将带你完成部署自己的 ERC20 合约到 BTY 测试链，包括合约编写、Hardhat使用，以及前端如何与合约交互。

---

## 📋 目录

- [一、什么是ERC20？](#一什么是erc20)
- [二、代币类型对比](#二代币类型对比)
- [三、ERC20接口详解](#三erc20接口详解)
- [四、为什么使用OpenZeppelin？](#四为什么使用openzeppelin)
- [五、HardHat部署合约](#五HardHat部署合约)
- [六、前端与ERC20合约对接](#六前端与erc20合约对接)

---

## 一、什么是ERC20？

### 🎯 核心概念

**ERC20** 是以太坊及兼容链上发行代币的标准协议，它定义了一套统一的代币接口规范，让钱包、交易所、智能合约能够识别和转账这些Token。

### 🔑 关键特性

- **标准化接口** - 统一的函数命名和参数
- **互操作性** - 所有支持ERC20的钱包和交易所都能识别
- **可编程性** - 支持复杂的代币逻辑和治理机制
- **可组合性** - 可以与其他DeFi协议无缝集成

---

## 二、代币类型对比

### 📊 区块链资产分类

| 类型 | 示例 | 创造者 | 作用 | 特点 |
|------|------|--------|------|------|
| **原生代币** | ETH, BTY | 链本身生成 | 支付Gas，保障网络运行 | 无需合约，直接由链提供 |
| **ERC20代币** | USDT, USDC | 智能合约发行 | 项目方资产、GameFi道具、平台币 | 通过智能合约实现 |
| **包装代币** | WETH, WBTY | 由桥接合约包装 | 把原生代币包装成ERC20 | 使原生代币能在合约内使用 |

### ❗ 为什么需要包装代币？

原生代币不是ERC20格式，不能直接用于智能合约交易，所以需要"包装"成ERC20格式：

- **WETH (Wrapped ETH)** - 以太坊原生代币的ERC20版本
- **WBTY (Wrapped BTY)** - BTY原生代币的ERC20版本

---

## 三、ERC20接口详解

### 🔧 核心函数

| 函数 | 作用 | 返回值 |
|------|------|--------|
| `totalSupply()` | 总发行量 |  uint256 |
| `balanceOf(address)` | 查询余额 | uint256 |
| `transfer(to, amount)` | 转账 |  bool |
| `approve(spender, amount)` | 授权 |  bool |
| `allowance(owner, spender)` | 授权额度查询 |  uint256 |
| `transferFrom(from, to, amount)` | 代理转账 |  bool |

### 📝 事件日志

| 事件 | 作用 | 
|------|------|
| `Transfer` | 转账记录日志 | 
| `Approval` | 授权记录日志 | 

### 💡 授权机制详解

ERC20的授权机制允许第三方代表你操作代币：

1. **授权** - 你允许DEX使用你的代币
2. **代理转账** - DEX代表你完成交易
3. **自动扣费** - 无需你手动确认每笔交易

---

## 四、为什么使用OpenZeppelin？

### ⚠️ 自己编写ERC20的风险

理论上任何人都能从零写ERC20，但存在以下风险：

- **🔒 安全漏洞** - 容易写错导致代币安全事故
- **📝 日志缺失** - 容易忘记log导致交易不可追踪
- **🎯 攻击风险** - 容易被重入攻击、整数溢出等
- **🔌 兼容性问题** - 钱包/链上工具可能识别不了

### ✅ OpenZeppelin的优势

```solidity
import "@openzeppelin/contracts/token/ERC20/ERC20.sol";
```

**OpenZeppelin** 是目前业界标准，具有以下优势：

- **🛡️ 安全性** - 经过大量审计和实战验证
- **🔧 标准化** - 完全符合ERC20标准
- **📚 文档完善** - 详细的开发文档和示例

---

## 五、HardHat部署合约

> 🚀 **完整的合约部署流程，从私钥准备到合约上链**

### 📋 部署前准备

### 1. 生成部署地址

```bash
# 生成一个新的地址用于部署合约
./bityuan-cli.exe account create -t 2 -l hardhat
```

### 2. 获取测试币

### 3. 导出私钥

```bash
# 导出部署地址的私钥
./bityuan-cli.exe account dump_key -a <部署地址>
```

**安全提醒**：
- ⚠️ 私钥信息敏感，请妥善保管
- ⚠️ 不要将私钥提交到代码仓库
- ⚠️ 用主链测试，测试完成后及时转移剩余资金

### 4. 执行部署流程

> 📚 **详细操作步骤请参考 [hardhat-project/README.md](./hardhat-project/README.md)**

---

## 六、前端与ERC20合约对接（DAPP开发）

> 🌐 **ERC20管理DAPP界面，代币管理功能DEMO**

### 技术栈选择

**前端框架**：Vue 3
**区块链交互**：Ethers.js 5.7.2

### 核心功能实现(以下只演示核心流程，如果要产品化，可以此基础上做二次开发)

 📚 **详细操作步骤请参考 [frontend-project/README.md](./frontend-project/README.md)**

#### 1. 钱包连接管理
- **连接钱包**：支持MetaMask等主流钱包
- **断开连接**：断开钱包连接
- **地址显示**：显示当前连接的钱包地址

#### 2. 代币发行功能
- **代币创建**：自定义代币名称、符号、初始供应量
- **增发控制**：选择是否支持后续增发功能

#### 3. 代币增发功能
- **合约信息获取**：自动获取代币基本信息
- **权限验证**：只有合约owner才能增发
- **增发操作**：为已部署的代币增加供应量
- **状态更新**：实时显示增发后的总供应量

#### 4. 钱包转账功能

